```{R}
library(dplyr)
data=read.csv("athlete_events.csv")
#target sport
Sport="Basketball"
topNth=10
#filter data 首先取得所有参加过篮球比赛的运动员
if(Sport=="All"){
  D=data[!is.na(data),]
}else{
  D=data[which(data$Sport==Sport),]
}
D=D%>%group_by(Year,NOC,Sport,Event,Medal)%>%filter(!is.na(Medal))%>%summarise(n=1)%>%group_by(NOC)%>%summarise(Gold=sum(Medal=="Gold"),Silver=sum(Medal=="Silver"),Bronze=sum(Medal=="Bronze"),Weight=sum(Medal=="Bronze")+1.5*sum(Medal=="Silver")+2*sum(Medal=="Gold"))%>%arrange(desc(Weight))%>%head(topNth)
```