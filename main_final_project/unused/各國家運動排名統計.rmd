```{R}
library(dplyr)
data=read.csv("athlete_events.csv")

#建立LEN(UNIQUE(data$NOC))*11的dataframe
unique_data=data.frame(matrix(ncol=13,nrow=length(unique(data$NOC))))
colnames(unique_data)=c("NOC","Sport1","Gold1","Silver1","Bronze1","Sport2","Gold2","Silver2","Bronze2","Sport3","Gold3","Silver3","Bronze3")
#init NOC
unique_data$NOC=unique(data$NOC)



for(NOC in unique_data$NOC){

        top3=data[which(data$NOC==NOC),]%>%group_by(Year,Sport,Event,Medal)%>%filter(!is.na(Medal))%>%summarise(n=1)%>%
        group_by(Sport)%>%summarise(Gold=sum(Medal=="Gold"),Silver=sum(Medal=="Silver"),Bronze=sum(Medal=="Bronze"))%>%
        mutate(Total=Gold*2+Silver*1.5+Bronze*1)%>%arrange(desc(Total))%>%head(3)

        top3_wide=unlist(c(top3[0,1],top3[1,1],top3[1,2],top3[1,3],top3[1,4],top3[2,1],top3[2,2],top3[2,3],top3[2,4],top3[3,1],top3[3,2],top3[3,3],top3[3,4]))

        unique_data[which(unique_data$NOC==NOC),2:13]=top3_wide

}


```
```{R}
library(dplyr)

# 读取数据
data <- read.csv("athlete_events.csv")

# 初始化新的数据框，包含所有的NOC和初始化的其他列
unique_nocs <- unique(data$NOC)
col_names <- c("NOC","Sport1","Gold1","Silver1","Bronze1","Sport2","Gold2","Silver2","Bronze2","Sport3","Gold3","Silver3","Bronze3")
unique_data <- data.frame(matrix(ncol = length(col_names), nrow = length(unique_nocs)))
colnames(unique_data) <- col_names
unique_data$NOC <- unique_nocs

# 为每个NOC计算前三种运动的奖牌
results <- lapply(unique_nocs, function(NOC) {
  subset_data <- data[data$NOC == NOC & !is.na(data$Medal),]
  summary <- subset_data %>%
    group_by(Year, Sport, Event, Medal) %>%
    summarise(n = n(), .groups = 'drop') %>%
    group_by(Sport) %>%
    summarise(
      Gold = sum(Medal == "Gold"),
      Silver = sum(Medal == "Silver"),
      Bronze = sum(Medal == "Bronze"),
      .groups = 'drop'
    ) %>%
    mutate(Total = Gold * 2 + Silver * 1.5 + Bronze * 1) %>%
    arrange(desc(Total)) %>%
    slice_head(n = 3) %>%
    ungroup()
  # 将结果转换为向量
  c(NOC, unlist(c(summary[1,1], summary[1,2:4], summary[2,1], summary[2,2:4], summary[3,1], summary[3,2:4])))
})

# 组合结果回数据框
results_df <- do.call(rbind, results)
colnames(results_df) <- col_names
#to df
results_df=data.frame(results_df)


```

